{"version":3,"file":"auth-B3oSFb2k.js","sources":["../../core/auth.js"],"sourcesContent":["// OAuth configuration for storage providers\n// Note: In production, you should create your own OAuth apps for each provider\n\nexport const OAUTH_CONFIG = {\n  dropbox: {\n    clientId: 'lgtet4ml5qp0qo8',\n    redirectUri: window.location.origin + '/auth-callback.html',\n    authEndpoint: 'https://www.dropbox.com/oauth2/authorize',\n    scopes: 'files.content.write files.content.read'\n  },\n  \n  onedrive: {\n    clientId: '460ec8b8-1a36-4565-bd95-6d88726e7b65',\n    redirectUri: window.location.origin + '/auth-callback.html',\n    authority: 'https://login.microsoftonline.com/common',\n    scopes: ['Files.ReadWrite', 'User.Read']\n  },\n  \n  googledrive: {\n    clientId: '813636040653-ub690hjmd47hknlb9g6pu5bet9d5mv0v.apps.googleusercontent.com',\n    redirectUri: window.location.origin,\n    authEndpoint: 'https://accounts.google.com/o/oauth2/v2/auth',\n    scopes: 'https://www.googleapis.com/auth/drive.file',\n    discoveryDocs: ['https://www.googleapis.com/discovery/v1/apis/drive/v3/rest']\n  }\n};\n\n// Storage keys\nexport const PROVIDER_KEY = 'noteel_selected_provider_v1';\nexport const TOKENS_KEY = 'noteel_oauth_tokens_v1';\n\n// Get selected storage provider\nexport function getSelectedProvider() {\n  return localStorage.getItem(PROVIDER_KEY) || null;\n}\n\n// Set selected storage provider\nexport function setSelectedProvider(provider) {\n  localStorage.setItem(PROVIDER_KEY, provider);\n}\n\n// Get OAuth tokens for a provider\nexport function getTokens(provider) {\n  const tokens = localStorage.getItem(TOKENS_KEY);\n  if (!tokens) return null;\n  try {\n    const parsed = JSON.parse(tokens);\n    return parsed[provider] || null;\n  } catch {\n    return null;\n  }\n}\n\n// Save OAuth tokens for a provider\nexport function saveTokens(provider, tokens) {\n  let allTokens = {};\n  const existing = localStorage.getItem(TOKENS_KEY);\n  if (existing) {\n    try {\n      allTokens = JSON.parse(existing);\n    } catch {\n      // ignore\n    }\n  }\n  allTokens[provider] = tokens;\n  localStorage.setItem(TOKENS_KEY, JSON.stringify(allTokens));\n}\n\n// Clear OAuth tokens for a provider\nexport function clearTokens(provider) {\n  const existing = localStorage.getItem(TOKENS_KEY);\n  if (!existing) return;\n  try {\n    const allTokens = JSON.parse(existing);\n    delete allTokens[provider];\n    localStorage.setItem(TOKENS_KEY, JSON.stringify(allTokens));\n  } catch {\n    // ignore\n  }\n}\n\n// Generate random state for OAuth\nexport function generateState() {\n  const array = new Uint8Array(16);\n  crypto.getRandomValues(array);\n  return Array.from(array, byte => byte.toString(16).padStart(2, '0')).join('');\n}\n\n// Generate PKCE code verifier\nexport function generateCodeVerifier() {\n  const array = new Uint8Array(32);\n  crypto.getRandomValues(array);\n  return base64URLEncode(array);\n}\n\n// Generate PKCE code challenge from verifier\nexport async function generateCodeChallenge(verifier) {\n  const encoder = new TextEncoder();\n  const data = encoder.encode(verifier);\n  const hash = await crypto.subtle.digest('SHA-256', data);\n  return base64URLEncode(new Uint8Array(hash));\n}\n\n// Base64 URL encoding helper\nfunction base64URLEncode(buffer) {\n  const base64 = btoa(String.fromCharCode(...buffer));\n  return base64.replace(/\\+/g, '-').replace(/\\//g, '_').replace(/=/g, '');\n}\n\n// Parse OAuth callback hash/query parameters\nexport function parseOAuthCallback() {\n  const hash = window.location.hash.substring(1);\n  const query = window.location.search.substring(1);\n  const params = new URLSearchParams(hash || query);\n  return {\n    accessToken: params.get('access_token'),\n    code: params.get('code'),\n    state: params.get('state'),\n    error: params.get('error'),\n    errorDescription: params.get('error_description')\n  };\n}\n"],"names":["OAUTH_CONFIG","PROVIDER_KEY","TOKENS_KEY","getSelectedProvider","setSelectedProvider","provider","getTokens","tokens","saveTokens","allTokens","existing","generateState","array","byte","generateCodeVerifier","base64URLEncode","generateCodeChallenge","verifier","data","hash","buffer","parseOAuthCallback","query","params"],"mappings":"ssBAGY,MAACA,EAAe,CAC1B,QAAS,CACP,SAAU,kBACV,YAAa,OAAO,SAAS,OAAS,sBACtC,aAAc,0CAEhB,EAEA,SAAU,CACR,SAAU,uCACV,YAAa,OAAO,SAAS,OAAS,sBACtC,UAAW,2CACX,OAAQ,CAAC,kBAAmB,WAAW,CAC3C,EAEE,YAAa,CACX,SAAU,2EACV,YAAa,OAAO,SAAS,OAC7B,aAAc,+CACd,OAAQ,4CAEV,CACF,EAGaC,EAAe,8BACfC,EAAa,yBAGnB,SAASC,GAAsB,CACpC,OAAO,aAAa,QAAQF,CAAY,GAAK,IAC/C,CAGO,SAASG,EAAoBC,EAAU,CAC5C,aAAa,QAAQJ,EAAcI,CAAQ,CAC7C,CAGO,SAASC,EAAUD,EAAU,CAClC,MAAME,EAAS,aAAa,QAAQL,CAAU,EAC9C,GAAI,CAACK,EAAQ,OAAO,KACpB,GAAI,CAEF,OADe,KAAK,MAAMA,CAAM,EAClBF,CAAQ,GAAK,IAC7B,MAAQ,CACN,OAAO,IACT,CACF,CAGO,SAASG,EAAWH,EAAUE,EAAQ,CAC3C,IAAIE,EAAY,CAAA,EAChB,MAAMC,EAAW,aAAa,QAAQR,CAAU,EAChD,GAAIQ,EACF,GAAI,CACFD,EAAY,KAAK,MAAMC,CAAQ,CACjC,MAAQ,CAER,CAEFD,EAAUJ,CAAQ,EAAIE,EACtB,aAAa,QAAQL,EAAY,KAAK,UAAUO,CAAS,CAAC,CAC5D,CAgBO,SAASE,GAAgB,CAC9B,MAAMC,EAAQ,IAAI,WAAW,EAAE,EAC/B,cAAO,gBAAgBA,CAAK,EACrB,MAAM,KAAKA,EAAOC,GAAQA,EAAK,SAAS,EAAE,EAAE,SAAS,EAAG,GAAG,CAAC,EAAE,KAAK,EAAE,CAC9E,CAGO,SAASC,GAAuB,CACrC,MAAMF,EAAQ,IAAI,WAAW,EAAE,EAC/B,cAAO,gBAAgBA,CAAK,EACrBG,EAAgBH,CAAK,CAC9B,CAGO,eAAeI,EAAsBC,EAAU,CAEpD,MAAMC,EADU,IAAI,YAAW,EACV,OAAOD,CAAQ,EAC9BE,EAAO,MAAM,OAAO,OAAO,OAAO,UAAWD,CAAI,EACvD,OAAOH,EAAgB,IAAI,WAAWI,CAAI,CAAC,CAC7C,CAGA,SAASJ,EAAgBK,EAAQ,CAE/B,OADe,KAAK,OAAO,aAAa,GAAGA,CAAM,CAAC,EACpC,QAAQ,MAAO,GAAG,EAAE,QAAQ,MAAO,GAAG,EAAE,QAAQ,KAAM,EAAE,CACxE,CAGO,SAASC,GAAqB,CACnC,MAAMF,EAAO,OAAO,SAAS,KAAK,UAAU,CAAC,EACvCG,EAAQ,OAAO,SAAS,OAAO,UAAU,CAAC,EAC1CC,EAAS,IAAI,gBAAgBJ,GAAQG,CAAK,EAChD,MAAO,CACL,YAAaC,EAAO,IAAI,cAAc,EACtC,KAAMA,EAAO,IAAI,MAAM,EACvB,MAAOA,EAAO,IAAI,OAAO,EACzB,MAAOA,EAAO,IAAI,OAAO,EACzB,iBAAkBA,EAAO,IAAI,mBAAmB,CACpD,CACA"}